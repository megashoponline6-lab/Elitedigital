<!-- âœ… views/client/shop.ejs -->
<% layout('layout-client') %>

<%- include('../partials/errors') %>
<%- include('../partials/success') %>

<div class="container mt-5 text-light">
  <h1 class="mb-4 text-center">ðŸ›’ Tienda de Plataformas</h1>

  <% if (platforms.length === 0) { %>
    <div class="alert alert-secondary text-center">
      No hay plataformas disponibles por el momento.
    </div>
  <% } else { %>
    <div class="row g-4">
      <% platforms.forEach(p => { %>
        <div class="col-md-4">
          <div class="card bg-dark border-secondary shadow h-100">
            <div class="card-header text-center border-secondary">
              <h4 class="mb-0"><%= p.name || p.nombre %></h4>
            </div>

            <div class="card-body d-flex flex-column justify-content-between">
              <% if (p.image || p.logoUrl) { %>
                <div class="text-center mb-3">
                  <img
                    src="<%= p.image || p.logoUrl %>"
                    alt="<%= p.name %>"
                    class="img-fluid rounded"
                    style="max-height: 120px; object-fit: contain;"
                  />
                </div>
              <% } %>

              <p class="text-center text-secondary">
                Compra cuentas disponibles de <%= p.name || p.nombre %> al instante.
              </p>

              <form action="/comprar" method="POST" class="mt-auto">
                <input type="hidden" name="platformId" value="<%= p._id %>" />

                <div class="d-flex justify-content-center align-items-center gap-2">
                  <label class="form-label mb-0">Cantidad:</label>
                  <input
                    type="number"
                    name="quantity"
                    min="1"
                    value="1"
                    class="form-control form-control-sm bg-dark text-light border-secondary w-25"
                    required
                  />
                </div>

                <div class="text-center mt-3">
                  <button type="submit" class="btn btn-danger w-100">
                    Comprar ahora
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      <% }) %>
    </div>
  <% } %>
</div>
