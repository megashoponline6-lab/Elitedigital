<% var title = 'Mi Panel'; %>

<h2 class="mb-3">Hola, <%= user.nombre %> ðŸ‘‹</h2>

<% if (ok) { %>
  <div class="alert alert-success"><%= ok %></div>
<% } %>
<% if (error) { %>
  <div class="alert alert-danger"><%= error %></div>
<% } %>

<div class="row g-3">
  <div class="col-md-4">
    <div class="card bg-black border-secondary rounded-4">
      <div class="card-body">
        <h5 class="fw-bold text-danger">Mis datos</h5>
        <p><strong>Nombre:</strong> <%= user.nombre %> <%= user.apellido %></p>
        <p><strong>PaÃ­s:</strong> <%= user.pais %></p>
        <p><strong>Correo:</strong> <%= user.correo %></p>
        <% if (user.telefono) { %>
          <p><strong>TelÃ©fono:</strong> <%= user.telefono %></p>
        <% } %>
        <p class="display-6 text-success mt-3">Saldo: $<%= user.saldo %> MXN</p>
        <a href="/catalogo" class="btn btn-danger btn-sm w-100 mt-3">Comprar suscripciÃ³n</a>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card bg-black border-secondary rounded-4">
      <div class="card-body">
        <h5 class="fw-bold text-danger">Suscripciones</h5>
        <% if (subs && subs.length) { %>
          <ul class="list-group list-group-flush">
            <% subs.forEach(s => { %>
              <li class="list-group-item bg-black text-light border-secondary">
                <strong><%= s.producto %></strong><br>
                Vence: <%= dayjs(s.vence_en).format('DD/MM/YYYY') %>
              </li>
            <% }) %>
          </ul>
        <% } else { %>
          <p class="text-secondary small mb-0">AÃºn no tienes suscripciones activas.</p>
        <% } %>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card bg-black border-secondary rounded-4">
      <div class="card-body">
        <h5 class="fw-bold text-danger">Mis credenciales entregadas</h5>
        <% if (asignaciones && asignaciones.length) { %>
          <div class="table-responsive">
            <table class="table table-dark table-sm align-middle mb-0">
              <thead>
                <tr>
                  <th>Servicio</th>
                  <th>Correo</th>
                  <th>ContraseÃ±a</th>
                  <th>Vence</th>
                </tr>
              </thead>
              <tbody>
                <% asignaciones.forEach(a => { %>
                  <tr>
                    <td><%= a.producto %></td>
                    <td><code><%= a.correo %></code></td>
                    <td><code><%= a.password %></code></td>
                    <td><%= dayjs(a.end_at).format('DD/MM/YYYY') %></td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
        <% } else { %>
          <p class="text-secondary small mb-0">AÃºn no tienes credenciales asignadas.</p>
        <% } %>
      </div>
    </div>
  </div>
</div>

<hr class="my-4">
<div class="text-center">
  <a href="https://t.me/EliteflixSoporte" target="_blank" class="btn btn-outline-danger me-2">ðŸ’¬ Soporte Telegram</a>
  <a href="https://t.me/EliteflixCanal" target="_blank" class="btn btn-danger">ðŸ“¢ Canal Oficial</a>
</div>
